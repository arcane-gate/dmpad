(this.webpackJsonpreact=this.webpackJsonpreact||[]).push([[0],{49:function(t,e,n){},50:function(t,e,n){},52:function(t,e,n){},53:function(t,e,n){},68:function(t,e,n){},69:function(t,e,n){},72:function(t,e,n){"use strict";n.r(e);var c=n(0),r=n.n(c),o=n(19),a=n.n(o),i=(n(49),n(9)),s=n(8),d=n(13),l=n(29),u=n(36),p=n(37),h=n(4),f=n(76),m=(n(50),n(5)),b=function(){return Object(m.jsxs)(d.c,{className:"action-item",children:[Object(m.jsxs)("span",{className:"label",contentEditable:!1,children:[Object(m.jsx)(f.a,{})," Action Item"]}),Object(m.jsx)(d.b,{className:"content"})]})},j={node:h.d.create({name:"actionItem",group:"block",content:"inline*",parseHTML:function(){return[{tag:"action-item"}]},renderHTML:function(t){var e=t.HTMLAttributes;return["action-item",Object(h.k)(e),0]},addNodeView:function(){return Object(d.d)(b)}}),slash:{title:"action item",element:Object(m.jsxs)("span",{children:[Object(m.jsx)(f.a,{})," Action Item"]}),command:function(t){var e=t.editor,n=t.range;e.chain().focus().deleteRange(n).setNode("actionItem",{}).run()}}},O=n(77),v=(n(52),function(t){t.editor,t.getPos;return Object(m.jsxs)(d.c,{className:"stat-block",children:[Object(m.jsxs)("span",{className:"label",contentEditable:!1,children:[Object(m.jsx)(O.a,{})," Stat Block"]}),Object(m.jsx)(d.b,{className:"content"})]})}),x={node:h.d.create({name:"statBlock",group:"block",content:"block*",defaultOptions:{HTMLAttributes:{}},defining:!0,parseHTML:function(){return[{tag:"stat-block"}]},renderHTML:function(t){var e=t.HTMLAttributes;return["stat-block",Object(h.k)(this.options.HTMLAttributes,e),0]},addNodeView:function(){return Object(d.d)(v)}}),slash:{title:"stat block",element:Object(m.jsxs)("span",{children:[Object(m.jsx)(O.a,{})," Stat Block"]}),command:function(t){var e=t.editor,n=t.range,c=t.props;e.chain().focus().insertContentAt(n,[{type:"statBlock",attrs:c,content:[{type:"paragraph"}]}]).run()},allow:function(t){var e=t.editor,n=t.range;return e.can().insertContentAt(n,{type:"statBlock"})}}},g={slash:{title:"import from ddb",element:Object(m.jsxs)("span",{children:[Object(m.jsx)(O.a,{})," Import from DDB"]}),command:function(t){t.editor.chain().focus(),window.editor=t.editor;var e=new CustomEvent("ddbImport",{detail:t});document.dispatchEvent(e)},allow:function(t){var e=t.editor,n=t.range;return e.can().insertContentAt(n,{type:"statBlock"})}}},y=n(38),k=n(26),w=n(3),C=n(15),I=(n(53),n(39)),A=new(n.n(I).a),M=Object(k.a)(/(?:^|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])(([0-9]+d[0-9]+\+?)+)/gi,{dice:1}),N=/^(\d+d\d+\+?)+$/gim,L=h.c.create({name:"dice-notation",priority:1e3,inclusive:!1,defaultOptions:{rollOnClick:!0,createOnPaste:!0,createOnType:!0},parseHTML:function(){return[{tag:"span.dice-notation"}]},renderHTML:function(t){var e=t.HTMLAttributes;return["span.dice-notation",Object(h.k)(this.options.HTMLAttributes,e),0]},addPasteRules:function(){return[Object(h.j)(M,this.type)]},addProseMirrorPlugins:function(){var t=this,e=[],n=function(t){var e=[];return function(t){var e=[];return t.descendants((function(t,n){if(t.isText&&t.text){var c,r=Object(y.a)(t.text.matchAll(M));try{for(r.s();!(c=r.n()).done;){var o,a=c.value;if(null===(o=a.groups)||void 0===o?void 0:o.dice){var i=((null===a||void 0===a?void 0:a.index)||0)+a[0].indexOf(a.groups.dice),s=a.groups.dice.length;e.push({from:n+i,to:n+i+s})}}}catch(d){r.e(d)}finally{r.f()}}})),e}(t).forEach((function(t){e.push(C.a.inline(t.from,t.to,{class:"dice-notation"}))})),C.b.create(t,e)},c=new w.d({state:{init:function(t,e){var c=e.doc;return n(c)},apply:function(t,e){return t.docChanged?n(t.doc):e}},props:{decorations:function(t){return this.getState(t)}}});return e.push(c),this.options.rollOnClick&&e.push(new w.d({key:new w.e("handleClickDiceNotation"),props:{handleClick:function(e,n,c){var r,o,a=null===(r=c.target)||void 0===r?void 0:r.textContent.trim(),i=(t.editor.getAttributes("dice-notation"),null===(o=c.target)||void 0===o?void 0:o.closest(".dice-notation"));if(!a||!i)return!1;var s=A.roll(a).result;c.ctrlKey||alert(a+" = "+s)}}})),this.options.createOnPaste&&e.push(new w.d({key:new w.e("handlePasteDiceNotation"),props:{handlePaste:function(e,n,c){if(e.state.selection.empty)return!1;var r="";return c.content.forEach((function(t){r+=t.textContent})),!(!r||!r.match(N))&&(t.editor.commands.setMark(t.type),!0)}}})),e}}),H=(n(68),n(10)),T=n(11),E=n(16),R=n(18),B=(n(69),function(t){Object(E.a)(n,t);var e=Object(R.a)(n);function n(){var t;Object(H.a)(this,n);for(var c=arguments.length,r=new Array(c),o=0;o<c;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))).state={selectedIndex:0},t}return Object(T.a)(n,[{key:"componentDidUpdate",value:function(t){this.props.items!==t.items&&this.setState({selectedIndex:0})}},{key:"onKeyDown",value:function(t){var e=t.event;return"ArrowUp"===e.key?(this.upHandler(),!0):"ArrowDown"===e.key?(this.downHandler(),!0):"Enter"===e.key&&(this.enterHandler(),!0)}},{key:"upHandler",value:function(){this.setState({selectedIndex:(this.state.selectedIndex+this.props.items.length-1)%this.props.items.length})}},{key:"downHandler",value:function(){this.setState({selectedIndex:(this.state.selectedIndex+1)%this.props.items.length})}},{key:"enterHandler",value:function(){this.selectItem(this.state.selectedIndex)}},{key:"selectItem",value:function(t){var e=this.props.items[t];e&&this.props.command(e)}},{key:"render",value:function(){var t=this,e=this.props.items;return Object(m.jsx)("div",{className:"items",children:e.map((function(e,n){return Object(m.jsx)("button",{className:"item ".concat(n===t.state.selectedIndex?"is-selected":""),onClick:function(){return t.selectItem(n)},children:e.element||e.title},n)}))})}}]),n}(r.a.Component)),S=n(23),D=(n(70),n(42)),P=n(78),J=n(79),z=n(80),U=n(81),W=[{title:"header 1",element:Object(m.jsxs)("span",{children:[Object(m.jsx)(P.a,{})," Header 1"]}),command:function(t){var e=t.editor,n=t.range;e.chain().focus().deleteRange(n).setNode("heading",{level:1}).run()}},{title:"header 2",element:Object(m.jsxs)("span",{children:[Object(m.jsx)(J.a,{})," Header 2"]}),command:function(t){var e=t.editor,n=t.range;e.chain().focus().deleteRange(n).setNode("heading",{level:2}).run()}},{title:"bold",element:Object(m.jsxs)("span",{children:[Object(m.jsx)(z.a,{})," Bold"]}),command:function(t){var e=t.editor,n=t.range;e.chain().focus().deleteRange(n).setMark("bold").run()}},{title:"italic",element:Object(m.jsxs)("span",{children:[Object(m.jsx)(U.a,{})," Italic"]}),command:function(t){var e=t.editor,n=t.range;e.chain().focus().deleteRange(n).setMark("italic").run()}}],F=function(t){var e=function(t){return D.a.configure({suggestion:{char:"/",startOfLine:!1,command:function(t){var e=t.editor,n=t.range;t.props.command({editor:e,range:n})},items:function(e){return[].concat(Object(s.a)(W),Object(s.a)(t.filter((function(t){return t.slash})).map((function(t){return t.slash})))).filter((function(t){return t.title.toLowerCase().startsWith(e.toLowerCase())})).slice(0,10)},render:function(){var t,e;return{onStart:function(n){t=new d.e(B,{props:n,editor:n.editor}),e=Object(S.a)("body",{getReferenceClientRect:n.clientRect,appendTo:function(){return document.body},content:t.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"})},onUpdate:function(n){t.updateProps(n),e[0].setProps({getReferenceClientRect:n.clientRect})},onKeyDown:function(e){var n;return null===(n=t.ref)||void 0===n?void 0:n.onKeyDown(e)},onExit:function(){e&&e[0]&&e[0].destroy(),t&&t.destroy()}}}}})}(t),n=t.map((function(t){return t.node?t.node:t}));return[].concat(Object(s.a)(n),[e])},G=n(40),Z=Object(G.a)("starter-doc"),K=F([].concat(Object(s.a)(Object(l.a)()),[u.a,p.a,j,x,g,L])),Y={type:"doc",content:[{type:"heading",attrs:{level:1},content:[{type:"text",text:"Welcome to DMpad"}]},{type:"paragraph",content:[{type:"text",text:"Try adding a block by typing "},{type:"text",marks:[{type:"code"}],text:"/"},{type:"text",text:". You can also use markdown syntax!"}]},{type:"actionItem",content:[{type:"text",text:"Try adding an action item with /action"}]},{type:"statBlock",content:[{type:"heading",attrs:{level:3},content:[{type:"text",text:"Stat Block"}]},{type:"paragraph"}]}]},V=function(){var t=Z(Y),e=Object(i.a)(t,2),n=e[0],c=e[1],r=Object(d.f)({extensions:K,editorProps:{attributes:{class:"Editor"}},onUpdate:function(){var t=this.getJSON();c(t)},content:n});return Object(m.jsx)(d.a,{editor:r})},Q=/https:\/\/(www.)?dndbeyond.com\/monsters\/([a-zA-Z0-9-]+)/,_=document.getElementById("modal-root"),X=function(t){var e=t.children,n=document.createElement("div");return n.classList.add("modal"),Object(c.useEffect)((function(){return _.appendChild(n),function(){_.removeChild(n)}})),a.a.createPortal(e,n)},$=Object(s.a)(Object(l.a)()),q=function(){var t=Object(c.useState)(""),e=Object(i.a)(t,2),n=e[0],r=e[1],o=Object(c.useState)(!1),a=Object(i.a)(o,2),d=a[0],l=a[1],u=Object(c.useRef)(null),p=Object(c.useRef)(null),f=function(t){var e=t.detail,n=(e.editor,e.range);u.current=n,l(!0)};Object(c.useEffect)((function(){return document.addEventListener("ddbImport",f),p.current&&p.current.focus(),function(){document.removeEventListener("ddbImport",f)}}));return d&&Object(m.jsx)(X,{children:Object(m.jsxs)("div",{className:"ImportModal",children:[Object(m.jsx)("input",{onChange:function(t){return r(t.target.value)},ref:p,value:n,placeholder:"https://www.dndbeyond.com/...",type:"text"}),Object(m.jsx)("button",{onClick:function(){n&&(window.editor&&u.current?function(t){if(Q.test(t)){var e=t.match(Q)[2];if(!e)throw new Error("No monster name!");return fetch("".concat("http://localhost:3000/proxy","/monsters"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cobalt:"eyJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0..M8BeGrinvr3bE20CGIu4dQ.1OyNemWcpERC-YOouORG2CWujm44ZbG_5CJfScM72gCH6dB19giu7C8ClS_YnRr0.ZguZxNaiLdVZHoYLzOkWHA",searchTerm:e,exactMatch:!0})})}}(n).then((function(t){return t.json()})).then((function(t){var e=t.data;return window.editor.chain().focus().insertContentAt(u.current,function(t){return t.map((function(t){var e=Object(h.g)(t.actionsDescription,$).content,n=(Object(h.g)(t.specialTraitsDescription,$).content,Object(h.g)(t.legendaryActionsDescription,$).content);return{type:"statBlock",content:[{type:"heading",attrs:{level:2},content:[{type:"text",text:t.name}]},{type:"horizontalRule"},e.length>0&&{type:"heading",attrs:{level:3},content:[{type:"text",text:"Actions"}]}].concat(Object(s.a)(e),[{type:"horizontalRule"},n.length>0&&{type:"heading",attrs:{level:3},content:[{type:"text",text:"Legendary Actions"}]}],Object(s.a)(n)).filter(Boolean)}}))}(e)).run()})).then((function(){u.current=null,l(!1)})):l(!1))},children:"Import"})]})})},tt=n.p+"static/media/logo.14afdede.svg";function et(){return Object(m.jsxs)("div",{className:"App",children:[Object(m.jsx)("div",{className:"main-nav",children:Object(m.jsxs)("div",{className:"inner",children:[Object(m.jsxs)("div",{children:[Object(m.jsx)("img",{src:tt,alt:"Logo",className:"logo"}),"dmpad"]}),Object(m.jsx)("nav",{children:Object(m.jsx)("a",{href:"https://wuz.sh",children:"Built by Wuz"})})]})}),Object(m.jsx)(V,{}),Object(m.jsx)(q,{})]})}var nt=document.getElementById("root");a.a.render(Object(m.jsx)(c.StrictMode,{children:Object(m.jsx)(et,{})}),nt)}},[[72,1,2]]]);
//# sourceMappingURL=main.1fee1226.chunk.js.map